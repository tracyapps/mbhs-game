# MBHS Game -- Asset Creation Guide

A practical, from-scratch reference for creating every art, audio, and animation
asset needed by the Marching Band Halftime Show game. Written for an experienced
programmer who is new to game asset creation. Targets Unity 6 LTS with URP,
shipping to PC and WebGL.

---

## Table of Contents

1. [Toolbox -- What to Install](#1-toolbox----what-to-install)
2. [Technical Constraints (PC + WebGL)](#2-technical-constraints-pc--webgl)
3. [Naming Conventions](#3-naming-conventions)
4. [Prioritized Asset Checklist by Phase](#4-prioritized-asset-checklist-by-phase)
5. [Character Models](#5-character-models)
6. [Instrument Models](#6-instrument-models)
7. [Uniform Materials](#7-uniform-materials)
8. [Environment Art](#8-environment-art)
9. [UI Art (Sprites, Icons, Fonts)](#9-ui-art-sprites-icons-fonts)
10. [VFX](#10-vfx)
11. [Animation](#11-animation)
12. [Audio](#12-audio)
13. [BeatMap JSON Files](#13-beatmap-json-files)
14. [ScriptableObject Data Assets](#14-scriptableobject-data-assets)
15. [Addressables Setup](#15-addressables-setup)
16. [URP + WebGL Gotchas](#16-urp--webgl-gotchas)
17. [Asset Store Placeholder Strategy](#17-asset-store-placeholder-strategy)
18. [Quick-Reference: File Path Map](#18-quick-reference-file-path-map)

---

## 1. Toolbox -- What to Install

All tools listed are free or have generous free tiers. You do not need all of
them on day one; install as each phase requires.

### 3D Modeling & Texturing

| Tool | Cost | Use |
|------|------|-----|
| **Blender 4.x** | Free | Character models, instrument models, environment props, UV unwrapping, rigging, weight painting |
| **Mixamo** (Adobe) | Free with Adobe account | Auto-rigging humanoid meshes, downloading marching/playing animation clips |
| **Material Maker** | Free (open source) | Procedural PBR textures (field turf, stadium concrete, metal) |

### 2D Art & UI

| Tool | Cost | Use |
|------|------|-----|
| **Krita** | Free | Painting textures, instrument icons, school logos, UI sprites |
| **GIMP** | Free | Photo editing, texture atlas packing, batch resizing |
| **Inkscape** | Free | Vector logos and icons (export to PNG for Unity) |

### Audio

| Tool | Cost | Use |
|------|------|-----|
| **Audacity** | Free | Recording, editing, exporting WAV/OGG, noise removal |
| **MuseScore 4** | Free | Composing marching band arrangements, exporting MIDI |
| **LMMS** | Free | Synthesizing instrument stems from MIDI, mixing |
| **Demucs** (Meta) | Free CLI | Stem separation if starting from a full mix |

### Utilities

| Tool | Cost | Use |
|------|------|-----|
| **Unity Addressables Profiler** | Built in | Debugging bundle sizes and load times |
| **RenderDoc** | Free | Debugging URP shaders in WebGL builds |
| **TexturePacker** (free mode) | Free tier | Sprite atlas packing for UI icons |

---

## 2. Technical Constraints (PC + WebGL)

WebGL is the most constrained target. Design to its limits and PC will be fine
automatically.

### Polygon Budgets

| Asset Category | Triangle Budget | Notes |
|----------------|-----------------|-------|
| Band member (body + uniform) | 1,500--3,000 tris | Up to 120 on screen simultaneously |
| Held instrument | 300--800 tris | Attached to hand bone; keep simple |
| Front ensemble instrument | 1,000--2,000 tris | Stationary on sideline; can be higher |
| Stadium / bleachers | 5,000--10,000 tris | Single mesh with LOD; mostly background |
| Field (ground plane) | 200--500 tris | Generated by `FieldRenderer.cs`; decoration only |
| Props (goal posts, towers) | 500--1,500 tris each | Few on screen |
| **Entire scene total** | ~500,000 tris | Target for 60 fps WebGL on integrated GPU |

### Texture Budgets

| Asset Category | Max Resolution | Format in Unity |
|----------------|---------------|-----------------|
| Character diffuse | 512x512 | ASTC 6x6 (mobile), DXT5 (PC), basis (WebGL) |
| Character normal map | 512x512 | Same as above; skip if stylized enough |
| Instrument diffuse | 256x256 | ASTC/DXT |
| Uniform color mask | 256x256 | Single-channel or RGB mask for tinting |
| Environment atlas | 1024x1024 | One atlas for all stadium surfaces |
| UI sprite atlas | 2048x2048 max | RGBA 32-bit for crisp icons |
| School logo | 256x256 | RGBA 32-bit, transparent background |
| Instrument icon | 128x128 | RGBA 32-bit, transparent background |

### Audio Budgets

| Asset | Format | Sample Rate | Channels | Notes |
|-------|--------|-------------|----------|-------|
| Full song mix | OGG Vorbis | 44100 Hz | Stereo | ~3--5 min, quality 5--7 |
| Stem (per family) | OGG Vorbis | 44100 Hz | Mono | Mono saves 50% size |
| SFX (whistle, crowd) | WAV or OGG | 44100 Hz | Mono | Short clips < 5 sec use WAV |
| UI sounds (click, etc.) | WAV | 22050 Hz | Mono | Tiny files, keep as WAV |

> **WebGL audio caveat**: WebGL cannot play MP3 in all browsers. Always use
> OGG Vorbis for music and WAV for short SFX. Unity's AudioClip import
> settings should have `Load Type: Compressed In Memory` for stems and
> `Streaming` for full mixes in PC builds. For WebGL, use
> `Decompress On Load` for short clips and `Compressed In Memory` for music.

---

## 3. Naming Conventions

Every asset name must be **predictable from code**. The codebase uses
`InstrumentType` and `InstrumentFamily` enum names as identifiers throughout.

### General Rules

- PascalCase for asset files: `Trumpet.fbx`, `SnareDrum_Icon.png`
- Underscores separate the base name from the suffix: `{Type}_{Suffix}.ext`
- Enum names are used verbatim -- `FrenchHorn`, not `French_Horn` or `frenchhorn`
- Prefabs end with no suffix (the folder provides context)
- Materials use `M_` prefix: `M_Uniform_Home`, `M_Trumpet`
- Textures use `T_` prefix: `T_BandMember_Diffuse`, `T_Field_Normal`
- Animation clips use `Anim_` prefix: `Anim_March_Forward`, `Anim_Play_Trumpet`
- Audio clips use no prefix (folder provides context)

### Instrument Type Names (from `InstrumentType` enum)

These are the exact strings to use in file names:

```
Brass:             Trumpet, Trombone, FrenchHorn, Tuba, Sousaphone,
                   Baritone, Mellophone
Woodwind:          Flute, Piccolo, Clarinet, Saxophone
BatteryPercussion: SnareDrum, BassDrum, TenorDrums, Cymbals
FrontEnsemble:     Xylophone, Marimba, Vibraphone, Timpani
ColorGuard:        Flag, Rifle, Saber
Leadership:        DrumMajor
```

### Instrument Family Names (from `InstrumentFamily` enum)

Used for stem audio and animation controllers:

```
Brass, Woodwind, BatteryPercussion, FrontEnsemble, ColorGuard, Leadership
```

---

## 4. Prioritized Asset Checklist by Phase

Work through these in order. Each phase builds on the previous one and unlocks
a playable milestone.

### Phase 1: Playable Prototype (replace capsules with *something*)

Goal: See recognizable band members marching on a field.

- [ ] **One generic band member model** (low-poly humanoid, no face detail)
      `Assets/_Project/Art/Characters/BandMember/BandMember.fbx`
- [ ] **Rig the model** with Mixamo (upload FBX, download rigged FBX)
      `Assets/_Project/Animation/Rigs/BandMember_Rig.fbx`
- [ ] **3 base animations** from Mixamo: idle, march forward, march in place
      `Assets/_Project/Animation/Clips/Anim_Idle.fbx`
      `Assets/_Project/Animation/Clips/Anim_March_Forward.fbx`
      `Assets/_Project/Animation/Clips/Anim_March_InPlace.fbx`
- [ ] **One Animator Controller** (base, shared by all families)
      `Assets/_Project/Animation/Controllers/AC_BandMember_Base.controller`
- [ ] **Placeholder uniform material** (solid color, tintable via script)
      `Assets/_Project/Art/Characters/Uniforms/M_Uniform_Default.mat`
- [ ] **Character prefab** wired to the model + animator
      `Assets/_Project/Prefabs/Characters/BandMember.prefab`
- [ ] **24 instrument icons** (simple flat color silhouettes, 128x128 PNG)
      `Assets/_Project/Art/UI/Icons/Trumpet_Icon.png` (repeat for all 24)
- [ ] **1 placeholder school logo** (256x256 PNG)
      `Assets/_Project/Art/UI/Icons/School_Default_Logo.png`
- [ ] **Basic SFX**: whistle blow, crowd murmur (2 WAV files)
      `Assets/_Project/Audio/SFX/SFX_Whistle.wav`
      `Assets/_Project/Audio/SFX/SFX_CrowdAmbient.wav`
- [ ] **1 placeholder song** with full mix audio (any marching-tempo OGG)
      `Assets/_Project/Audio/Music/Songs/Song_Default_FullMix.ogg`
- [ ] **1 BeatMap JSON** matching the placeholder song
      `Assets/_Project/Audio/BeatMaps/Song_Default.json`
- [ ] **24 InstrumentDefinition ScriptableObjects** (one per type)
      `Assets/_Project/Data/Instruments/Trumpet.asset` (repeat for all 24)
- [ ] **1 SchoolDefinition ScriptableObject**
      `Assets/_Project/Data/Schools/School_Default.asset`
- [ ] **1 ScoringRubricDefinition ScriptableObject**
      `Assets/_Project/Data/ScoringRubrics/Rubric_Standard.asset`

### Phase 2: Instruments Visible

Goal: Band members hold their instruments; different families look different.

- [ ] **7 brass instrument models** (FBX, 300--800 tris each)
      `Assets/_Project/Art/Characters/Instruments/Trumpet.fbx`
      `Assets/_Project/Art/Characters/Instruments/Trombone.fbx`
      `Assets/_Project/Art/Characters/Instruments/FrenchHorn.fbx`
      `Assets/_Project/Art/Characters/Instruments/Tuba.fbx`
      `Assets/_Project/Art/Characters/Instruments/Sousaphone.fbx`
      `Assets/_Project/Art/Characters/Instruments/Baritone.fbx`
      `Assets/_Project/Art/Characters/Instruments/Mellophone.fbx`
- [ ] **4 woodwind instrument models**
      `Assets/_Project/Art/Characters/Instruments/Flute.fbx`
      `Assets/_Project/Art/Characters/Instruments/Piccolo.fbx`
      `Assets/_Project/Art/Characters/Instruments/Clarinet.fbx`
      `Assets/_Project/Art/Characters/Instruments/Saxophone.fbx`
- [ ] **4 battery percussion models**
      `Assets/_Project/Art/Characters/Instruments/SnareDrum.fbx`
      `Assets/_Project/Art/Characters/Instruments/BassDrum.fbx`
      `Assets/_Project/Art/Characters/Instruments/TenorDrums.fbx`
      `Assets/_Project/Art/Characters/Instruments/Cymbals.fbx`
- [ ] **4 front ensemble models** (larger; stationary on sideline)
      `Assets/_Project/Art/Characters/Instruments/Xylophone.fbx`
      `Assets/_Project/Art/Characters/Instruments/Marimba.fbx`
      `Assets/_Project/Art/Characters/Instruments/Vibraphone.fbx`
      `Assets/_Project/Art/Characters/Instruments/Timpani.fbx`
- [ ] **3 color guard props**
      `Assets/_Project/Art/Characters/Instruments/Flag.fbx`
      `Assets/_Project/Art/Characters/Instruments/Rifle.fbx`
      `Assets/_Project/Art/Characters/Instruments/Saber.fbx`
- [ ] **1 drum major mace/baton**
      `Assets/_Project/Art/Characters/Instruments/DrumMajor.fbx`
- [ ] **24 instrument prefabs** (FBX + material, referenced by InstrumentDefinition)
      `Assets/_Project/Prefabs/Characters/Instruments/Trumpet.prefab` (repeat)
- [ ] **Materials for metal/wood/fabric** instruments
      `Assets/_Project/Art/Characters/Instruments/M_BrassInstrument.mat`
      `Assets/_Project/Art/Characters/Instruments/M_WoodInstrument.mat`
      `Assets/_Project/Art/Characters/Instruments/M_GuardProp.mat`
- [ ] **Update all 24 InstrumentDefinition assets** with:
      - `ModelPrefabAddressableKey` pointing to the instrument prefab
      - `Icon` pointing to the icon sprite
      - `HoldOffset` and `HoldRotation` tuned in the editor
      - `AnimOverride` (can stay null until Phase 3)

### Phase 3: Animations per Family

Goal: Each instrument family has distinct playing and marching animations.

- [ ] **6 AnimatorOverrideControllers** (one per InstrumentFamily)
      `Assets/_Project/Animation/Controllers/AOC_Brass.overrideController`
      `Assets/_Project/Animation/Controllers/AOC_Woodwind.overrideController`
      `Assets/_Project/Animation/Controllers/AOC_BatteryPercussion.overrideController`
      `Assets/_Project/Animation/Controllers/AOC_FrontEnsemble.overrideController`
      `Assets/_Project/Animation/Controllers/AOC_ColorGuard.overrideController`
      `Assets/_Project/Animation/Controllers/AOC_Leadership.overrideController`
- [ ] **Playing animations per family** (Mixamo or hand-animated in Blender)
      `Assets/_Project/Animation/Clips/Anim_Play_Brass.fbx`
      `Assets/_Project/Animation/Clips/Anim_Play_Woodwind.fbx`
      `Assets/_Project/Animation/Clips/Anim_Play_BatteryPercussion.fbx`
      `Assets/_Project/Animation/Clips/Anim_Play_FrontEnsemble.fbx`
      `Assets/_Project/Animation/Clips/Anim_Play_ColorGuard.fbx`
      `Assets/_Project/Animation/Clips/Anim_Play_Leadership.fbx`
- [ ] **Turning animations**: march turn left, march turn right
      `Assets/_Project/Animation/Clips/Anim_March_TurnLeft.fbx`
      `Assets/_Project/Animation/Clips/Anim_March_TurnRight.fbx`
- [ ] **Transition animations**: halt, attention, at-ease
      `Assets/_Project/Animation/Clips/Anim_Halt.fbx`
      `Assets/_Project/Animation/Clips/Anim_Attention.fbx`
      `Assets/_Project/Animation/Clips/Anim_AtEase.fbx`
- [ ] **Wire AnimOverride** into each InstrumentDefinition's `AnimOverride` field

### Phase 4: Environment & Stadium

Goal: The field looks like a real stadium instead of floating in a void.

- [ ] **Stadium bleachers model** (low-poly, mirrored for home/visitor)
      `Assets/_Project/Art/Environment/Stadium/Stadium_Bleachers.fbx`
- [ ] **Press box / tower**
      `Assets/_Project/Art/Environment/Stadium/Stadium_PressBox.fbx`
- [ ] **Goal posts** (2x)
      `Assets/_Project/Art/Environment/Stadium/Stadium_GoalPost.fbx`
- [ ] **Scoreboard**
      `Assets/_Project/Art/Environment/Stadium/Stadium_Scoreboard.fbx`
- [ ] **Track / surrounding ground**
      `Assets/_Project/Art/Environment/Stadium/Stadium_Track.fbx`
- [ ] **Stadium lights**
      `Assets/_Project/Art/Environment/Stadium/Stadium_Lights.fbx`
- [ ] **Skybox material** (evening/night football game look)
      `Assets/_Project/Art/Environment/Skybox/M_Skybox_FridayNight.mat`
- [ ] **Field texture** (turf pattern, yard-line numbers) -- NOTE: `FieldRenderer.cs`
      generates geometry, but you may want a ground texture overlay
      `Assets/_Project/Art/Environment/Stadium/T_FieldTurf_Diffuse.png`
- [ ] **Environment props**: sideline equipment, cones, water coolers
      `Assets/_Project/Art/Environment/Props/Prop_WaterCooler.fbx`
      `Assets/_Project/Art/Environment/Props/Prop_EquipmentCart.fbx`
- [ ] **Environment prefabs**
      `Assets/_Project/Prefabs/Environment/Stadium.prefab`
      `Assets/_Project/Prefabs/Environment/GoalPost.prefab`
      (etc.)
- [ ] **Crowd noise audio variants** (3--4 loops)
      `Assets/_Project/Audio/SFX/SFX_CrowdCheer_01.ogg`
      `Assets/_Project/Audio/SFX/SFX_CrowdCheer_02.ogg`

### Phase 5: Uniforms & School Identity

Goal: Each school looks distinct. Colors, logos, and uniform variants work.

- [ ] **Uniform base model** integrated into band member mesh (or as clothing mesh)
      -- If separate mesh: `Assets/_Project/Art/Characters/Uniforms/Uniform_Marching.fbx`
      -- The uniform uses a **color mask texture** so the shader can tint
         `PrimaryColor` and `SecondaryColor` from `SchoolDefinition`
- [ ] **Uniform color mask texture** (R = primary zone, G = secondary zone, B = accent)
      `Assets/_Project/Art/Characters/Uniforms/T_Uniform_ColorMask.png`
- [ ] **Uniform materials** (one per variant: home, away, special)
      `Assets/_Project/Art/Characters/Uniforms/M_Uniform_Home.mat`
      `Assets/_Project/Art/Characters/Uniforms/M_Uniform_Away.mat`
- [ ] **School logos** (one per school, 256x256 transparent PNG)
      `Assets/_Project/Art/UI/Icons/School_{SchoolId}_Logo.png`
- [ ] **Additional SchoolDefinition assets** (one per fictional school)
      `Assets/_Project/Data/Schools/School_Lincoln.asset`
      `Assets/_Project/Data/Schools/School_Riverside.asset`
      (etc.)
- [ ] **Drum major shako/hat model** (distinctive headgear)
      `Assets/_Project/Art/Characters/Uniforms/Uniform_Shako.fbx`

### Phase 6: Full Audio Pipeline

Goal: Songs have separated stems that respond to gameplay.

- [ ] **3--5 complete songs** each with 6 stems:
      - `Assets/_Project/Audio/Music/Stems/{SongId}/Stem_Brass.ogg`
      - `Assets/_Project/Audio/Music/Stems/{SongId}/Stem_Woodwind.ogg`
      - `Assets/_Project/Audio/Music/Stems/{SongId}/Stem_BatteryPercussion.ogg`
      - `Assets/_Project/Audio/Music/Stems/{SongId}/Stem_FrontEnsemble.ogg`
      - `Assets/_Project/Audio/Music/Stems/{SongId}/Stem_ColorGuard.ogg`
        (ambient/count track for guard timing)
      - `Assets/_Project/Audio/Music/Songs/{SongId}_FullMix.ogg`
- [ ] **BeatMap JSON** for each song
      `Assets/_Project/Audio/BeatMaps/{SongId}.json`
- [ ] **UI SFX set**: button click, panel open/close, success, failure, score reveal
      `Assets/_Project/Audio/SFX/SFX_UI_Click.wav`
      `Assets/_Project/Audio/SFX/SFX_UI_PanelOpen.wav`
      `Assets/_Project/Audio/SFX/SFX_UI_Success.wav`
      `Assets/_Project/Audio/SFX/SFX_UI_Failure.wav`
      `Assets/_Project/Audio/SFX/SFX_ScoreReveal.wav`
- [ ] **Gameplay SFX**: metronome tick, formation snap, crowd reaction levels
      `Assets/_Project/Audio/SFX/SFX_MetronomeTick.wav`
      `Assets/_Project/Audio/SFX/SFX_FormationSnap.wav`

### Phase 7: VFX & Polish

Goal: Visual feedback and juice.

- [ ] **Formation trail VFX** (shows path a member will march)
      `Assets/_Project/Art/VFX/VFX_FormationTrail.prefab`
- [ ] **Selection highlight VFX** (ring or glow under selected member)
      `Assets/_Project/Art/VFX/VFX_SelectionRing.prefab`
- [ ] **Score popup VFX** (floating text with grade)
      `Assets/_Project/Art/VFX/VFX_ScorePopup.prefab`
- [ ] **Confetti / celebration VFX** (Particle System, triggered on high score)
      `Assets/_Project/Art/VFX/VFX_Confetti.prefab`
- [ ] **Stadium lights flare** (lens flare or simple billboard)
      `Assets/_Project/Art/VFX/VFX_LightFlare.prefab`

---

## 5. Character Models

### Specs

- **Triangle count**: 1,500--3,000 for the body (clothes baked in or separate mesh)
- **Skeleton**: Mixamo-compatible humanoid (65 bones). Unity will retarget.
- **Single mesh preferred** for WebGL batching. Separate meshes for hat only.
- **No facial animation needed** -- camera is always at field distance.
- **T-pose or A-pose** for export. A-pose avoids shoulder deformation issues.

### Blender Workflow

1. Model a simple humanoid. Block out with cubes, refine.
   Do NOT sculpt -- keep it low-poly from the start.
2. UV unwrap. Single UV island sheet, 512x512.
3. Export as FBX: `File > Export > FBX`, set scale to 1.0, apply transforms,
   check "Apply Unit". Uncheck "Add Leaf Bones".
4. Upload to Mixamo for auto-rigging. Download rigged FBX
   ("FBX for Unity" preset, T-pose).
5. Re-import into Blender to verify rig, then export final FBX.

### Import Settings in Unity

- **Model tab**: Scale Factor = 1, Import Normals = Import, Animation Type = Humanoid
- **Rig tab**: Animation Type = Humanoid, Avatar Definition = Create From This Model
- **Animation tab**: (none on the mesh itself; animations are separate files)
- **Materials tab**: Location = Use External Materials (so you control them)

### Code Connection

The band member prefab is instantiated by the formation system. Currently uses
capsule primitives. Replace the capsule's MeshFilter/MeshRenderer with the
SkinnedMeshRenderer from your model. The prefab lives at:

```
Assets/_Project/Prefabs/Characters/BandMember.prefab
```

Instruments are attached as child GameObjects at runtime using the
`InstrumentDefinition.HoldOffset` and `InstrumentDefinition.HoldRotation`
fields. The instrument prefab is loaded via Addressables using
`InstrumentDefinition.ModelPrefabAddressableKey`.

---

## 6. Instrument Models

### Specs

| Category | Tri Budget | Texture | Notes |
|----------|-----------|---------|-------|
| Brass (held) | 300--800 | 256x256 shared brass atlas | Trumpet, Trombone, etc. |
| Woodwind (held) | 200--500 | 256x256 shared wood/metal atlas | Simpler shapes |
| Battery (worn) | 500--1,000 | 256x256 | Includes harness geometry |
| Front Ensemble | 1,000--2,000 | 512x512 | Stationary, viewed closer |
| Color Guard | 100--300 | 128x128 | Flag = plane + cloth sim or texture |
| Drum Major baton | 100--200 | 64x64 | Simple cylinder |

### Blender Tips for Instruments

- Use reference images. Search for "marching band [instrument] side view".
- Brass: Start with a cylinder, bend with curve modifier. Tubes + bell.
- Drums: Cylinders with loop cuts for rim detail.
- Flag: Subdivided plane. In Unity, either use cloth physics (PC only) or
  just bake a waving animation. For WebGL, baked animation is safer.
- Color guard rifle/saber: Simple extruded shapes. These are props, not
  real weapons -- stylize freely.

### File Paths

Each instrument model is saved as an FBX at:
```
Assets/_Project/Art/Characters/Instruments/{InstrumentType}.fbx
```

Each is then converted to a prefab at:
```
Assets/_Project/Prefabs/Characters/Instruments/{InstrumentType}.prefab
```

### Code Connection

`InstrumentDefinition.cs` fields:

| Field | Type | What to assign |
|-------|------|----------------|
| `Type` | `InstrumentType` enum | e.g. `Trumpet` |
| `Family` | `InstrumentFamily` enum | e.g. `Brass` |
| `DisplayName` | string | e.g. `"Trumpet"` |
| `Icon` | Sprite | Direct reference: `Trumpet_Icon.png` (set to Sprite mode) |
| `ModelPrefabAddressableKey` | string | Addressable key: `"Instrument_Trumpet"` |
| `HoldOffset` | Vector3 | Tune in editor. Start with `(0.15, 1.2, 0.3)` for brass |
| `HoldRotation` | Quaternion | Tune in editor. Identity to start |
| `AnimOverride` | AnimatorOverrideController | e.g. `AOC_Brass` |
| `VolumeContribution` | float | 0.5 default; Tuba/Sousaphone louder (0.7) |
| `MinRecommendedCount` | int | See table below |
| `MaxRecommendedCount` | int | See table below |
| `DifficultyToLearn` | int (1-10) | See table below |
| `PhysicalDemand` | int (1-10) | See table below |

### Recommended Counts & Stats (for a 120-member band)

| InstrumentType | Min | Max | Difficulty | PhysicalDemand |
|----------------|-----|-----|------------|----------------|
| Trumpet | 12 | 20 | 4 | 4 |
| Trombone | 6 | 12 | 5 | 5 |
| FrenchHorn | 4 | 8 | 7 | 4 |
| Tuba | 2 | 6 | 6 | 3 |
| Sousaphone | 4 | 8 | 6 | 8 |
| Baritone | 4 | 8 | 5 | 5 |
| Mellophone | 6 | 10 | 6 | 4 |
| Flute | 6 | 12 | 5 | 3 |
| Piccolo | 2 | 6 | 6 | 3 |
| Clarinet | 6 | 14 | 5 | 3 |
| Saxophone | 4 | 10 | 4 | 4 |
| SnareDrum | 3 | 6 | 7 | 7 |
| BassDrum | 2 | 5 | 4 | 9 |
| TenorDrums | 2 | 4 | 8 | 8 |
| Cymbals | 2 | 4 | 3 | 7 |
| Xylophone | 1 | 2 | 6 | 2 |
| Marimba | 1 | 3 | 7 | 2 |
| Vibraphone | 1 | 2 | 7 | 2 |
| Timpani | 1 | 2 | 6 | 3 |
| Flag | 6 | 12 | 4 | 6 |
| Rifle | 2 | 6 | 8 | 7 |
| Saber | 2 | 4 | 7 | 6 |
| DrumMajor | 1 | 3 | 9 | 5 |

---

## 7. Uniform Materials

### Design Approach: Color Mask Tinting

Instead of creating unique textures per school, use a single **color mask
texture** and let the shader tint regions based on `SchoolDefinition` colors.

1. Create `T_Uniform_ColorMask.png` (256x256):
   - **Red channel** = areas to tint with `PrimaryColor`
   - **Green channel** = areas to tint with `SecondaryColor`
   - **Blue channel** = areas to tint with `AccentColor`
   - **Black areas** = untinted (white fabric, black shoes, metal buttons)

2. Create a URP Shader Graph:
   - Sample the color mask
   - Multiply R by `_PrimaryColor`, G by `_SecondaryColor`, B by `_AccentColor`
   - Add them together plus the untinted base
   - Output to URP Lit base color

3. At runtime, the system creates material instances and sets color properties
   from `SchoolDefinition.PrimaryColor`, `SecondaryColor`, `AccentColor`.

### File Paths

```
Assets/_Project/Art/Characters/Uniforms/T_Uniform_ColorMask.png
Assets/_Project/Art/Characters/Uniforms/T_Uniform_Base_Diffuse.png
Assets/_Project/Art/Characters/Uniforms/M_Uniform_Home.mat
Assets/_Project/Art/Characters/Uniforms/M_Uniform_Away.mat
```

### Code Connection

`SchoolDefinition.cs` fields:

| Field | Type | What to assign |
|-------|------|----------------|
| `SchoolId` | string | Unique slug: `"lincoln"`, `"riverside"` |
| `SchoolName` | string | Display name: `"Lincoln High School"` |
| `Mascot` | string | `"Lions"` |
| `PrimaryColor` | Color | Picker in Inspector |
| `SecondaryColor` | Color | Picker in Inspector |
| `AccentColor` | Color | Picker in Inspector |
| `Logo` | Sprite | Direct ref: `School_Lincoln_Logo.png` |
| `UniformAddressableKey` | string | `"Uniform_Lincoln"` |
| `StadiumThemeAddressableKey` | string | `"Stadium_Lincoln"` |
| `StartingReputation` | int (0-100) | 50 for default |
| `StartingBudget` | int | 10000 |
| `StartingBandSize` | int (10-200) | 60 |
| `RecruitQualityBase` | float (0-1) | 0.5 |
| `RecruitsPerSeason` | int (1-20) | 10 |
| `Description` | string | Flavor text |
| `FightSongId` | string | Song ID reference, e.g. `"song_fight_lincoln"` |

---

## 8. Environment Art

### What FieldRenderer.cs Already Does

`FieldRenderer.cs` creates a 3D football field with yard lines procedurally.
Your environment art goes **around** this field, not replacing it.

### Stadium Structure

Build the stadium as modular pieces:

```
Assets/_Project/Art/Environment/Stadium/
    Stadium_Bleachers.fbx          -- Tiered rows, home side
    Stadium_Bleachers_Visitor.fbx  -- Mirror or reuse
    Stadium_PressBox.fbx           -- Top of home bleachers
    Stadium_GoalPost.fbx           -- Reused at both ends
    Stadium_Scoreboard.fbx         -- Far end zone
    Stadium_Lights.fbx             -- 4 light towers, corners
    Stadium_Track.fbx              -- Running track around field
    Stadium_Fence.fbx              -- Perimeter fencing
```

### Textures

Use a single **texture atlas** for all stadium surfaces:

```
Assets/_Project/Art/Environment/Stadium/T_Stadium_Atlas_Diffuse.png  (1024x1024)
Assets/_Project/Art/Environment/Stadium/T_Stadium_Atlas_Normal.png   (1024x1024)
```

UV-map all stadium meshes to this one atlas. This allows a single draw call
for the entire stadium (critical for WebGL performance).

### Skybox

A procedural skybox or a 6-sided cubemap works. For the Friday-night-lights
feel, use a dark blue gradient with warm horizon glow.

```
Assets/_Project/Art/Environment/Skybox/M_Skybox_FridayNight.mat
```

Use Unity's built-in Procedural Skybox shader or a simple Cubemap skybox.
Keep the cubemap at 512x512 per face for WebGL.

### Lighting

- Single directional light (moonlight or stadium-light motivated)
- 4 point lights on the stadium light towers
- Use baked lighting (Lightmaps) for the stadium to save real-time cost
- URP: set `Additional Lights` to `Per Pixel`, limit to 4 for WebGL

---

## 9. UI Art (Sprites, Icons, Fonts)

### Instrument Icons

One icon per `InstrumentType`. Simple flat silhouette style on transparent
background. Consistent line weight, consistent padding.

**Size**: 128x128 pixels, PNG, RGBA.

**File path**: `Assets/_Project/Art/UI/Icons/{InstrumentType}_Icon.png`

**Unity import**: Texture Type = Sprite (2D and UI), Pixels Per Unit = 100,
Filter Mode = Bilinear, Max Size = 128, Compression = None (for crisp UI).

**Code connection**: Each `InstrumentDefinition.Icon` Sprite field is assigned
the corresponding icon directly in the Inspector.

### School Logos

**Size**: 256x256 pixels, PNG, RGBA, transparent background.

**File path**: `Assets/_Project/Art/UI/Icons/School_{SchoolId}_Logo.png`

**Code connection**: `SchoolDefinition.Logo` Sprite field.

### Sprite Atlases

Group UI sprites into atlases to reduce draw calls:

```
Assets/_Project/Art/UI/Sprites/Atlas_InstrumentIcons.spriteatlasv2
Assets/_Project/Art/UI/Sprites/Atlas_UIElements.spriteatlasv2
```

Create these in Unity: `Assets > Create > 2D > Sprite Atlas`. Add the icon
folders as "Objects for Packing".

### Fonts

Use freely licensed fonts. Good options:

- **Roboto** or **Inter** for body text (clean, readable at small sizes)
- **Oswald** or **Bebas Neue** for headings and scoreboards (bold, condensed)

Place font files at:
```
Assets/_Project/Art/UI/Fonts/Roboto-Regular.ttf
Assets/_Project/Art/UI/Fonts/Oswald-Bold.ttf
```

The project uses UI Toolkit (UXML/USS). Reference fonts in USS files like:
```css
-unity-font-definition: resource("Fonts/Roboto-Regular SDF");
```

Generate TextMeshPro / UI Toolkit SDF font assets via
`Window > TextMeshPro > Font Asset Creator` if needed.

### UI Sprites (buttons, panels, etc.)

Use 9-slice sprites for resizable panels. Create at 64x64 with clear border
zones, then set border values in Unity's Sprite Editor.

```
Assets/_Project/Art/UI/Sprites/Panel_Background.png
Assets/_Project/Art/UI/Sprites/Button_Default.png
Assets/_Project/Art/UI/Sprites/Button_Hover.png
Assets/_Project/Art/UI/Sprites/Button_Pressed.png
```

---

## 10. VFX

All VFX should use Unity's **Particle System** (Shuriken) or **VFX Graph**.
For WebGL compatibility, prefer Particle System -- VFX Graph requires compute
shaders, which WebGL does not support.

### Formation Trail

Shows the path a band member will march between formations.

- Use a `LineRenderer` with a simple gradient material
- Or a trail of small quad particles
- Material: URP/Particles/Unlit, additive blend
- File: `Assets/_Project/Art/VFX/VFX_FormationTrail.prefab`

### Selection Ring

Highlights the currently selected band member in the formation editor.

- Projector decal (URP Decal Renderer) or flat quad at ground level
- Animated rotation or pulse
- File: `Assets/_Project/Art/VFX/VFX_SelectionRing.prefab`

### Score Popup

Floating text showing grade after a performance.

- Use TextMeshPro world-space text on a canvas
- Animate scale + vertical drift + fade
- File: `Assets/_Project/Art/VFX/VFX_ScorePopup.prefab`

### Confetti

Particle System. Quad particles with random rotation, gravity, and
color-over-lifetime matching school colors.

- Max 200 particles for WebGL
- File: `Assets/_Project/Art/VFX/VFX_Confetti.prefab`

---

## 11. Animation

### Architecture

```
Base Animator Controller (AC_BandMember_Base.controller)
    States: Idle, MarchForward, MarchInPlace, MarchTurn, Playing, Halt, Attention
    Parameters: IsMarching (bool), IsPlaying (bool), Speed (float),
                TurnDirection (float), Formation (trigger)

AnimatorOverrideController (one per InstrumentFamily)
    Overrides only the "Playing" clip with family-specific animation
    e.g., AOC_Brass overrides Playing -> Anim_Play_Brass
```

### Getting Animations from Mixamo

1. Go to mixamo.com, sign in with Adobe account
2. Upload your rigged band member FBX (or use a Mixamo character temporarily)
3. Search for and download:
   - "Walking" (rename to `Anim_March_Forward`) -- set tempo to ~120 BPM stride
   - "Idle" (rename to `Anim_Idle`)
   - "Standing" variations for playing poses
4. Download settings: FBX for Unity, Without Skin (animation only), 30 fps

### Animation Import in Unity

- **Rig tab**: Animation Type = Humanoid, Avatar = your BandMember avatar
- **Animation tab**: Loop Time = yes (for march, idle), Loop Pose = yes
- Adjust root motion: usually "Bake Into Pose" for Y position and XZ rotation
- Clip names should match what the Animator Controller expects

### Custom Playing Animations

Mixamo does not have "playing trumpet while marching" animations. Options:

1. **Mixamo + Blender layering**: Download a walk cycle and a gesture/arm pose
   separately. In Blender, combine them using the NLA Editor (upper body from
   one, lower body from the other). Export combined clip.

2. **Pose-only approach**: Create a single "playing pose" per family in Blender
   (arms in position). Use Unity's Animation Rigging package to blend the
   upper body pose onto the marching lower body at runtime. This is more
   flexible but requires the Animation Rigging package.

3. **Simplest approach for Phase 1**: Use Animator layers. Base layer = march
   cycle (full body). Override layer = upper body mask with playing pose.
   This requires an Avatar Mask:
   ```
   Assets/_Project/Animation/Rigs/AvatarMask_UpperBody.mask
   ```

### File Paths

```
Assets/_Project/Animation/Rigs/BandMember_Rig.fbx
Assets/_Project/Animation/Rigs/AvatarMask_UpperBody.mask
Assets/_Project/Animation/Clips/Anim_Idle.fbx
Assets/_Project/Animation/Clips/Anim_March_Forward.fbx
Assets/_Project/Animation/Clips/Anim_March_InPlace.fbx
Assets/_Project/Animation/Clips/Anim_March_TurnLeft.fbx
Assets/_Project/Animation/Clips/Anim_March_TurnRight.fbx
Assets/_Project/Animation/Clips/Anim_Halt.fbx
Assets/_Project/Animation/Clips/Anim_Attention.fbx
Assets/_Project/Animation/Clips/Anim_AtEase.fbx
Assets/_Project/Animation/Clips/Anim_Play_Brass.fbx
Assets/_Project/Animation/Clips/Anim_Play_Woodwind.fbx
Assets/_Project/Animation/Clips/Anim_Play_BatteryPercussion.fbx
Assets/_Project/Animation/Clips/Anim_Play_FrontEnsemble.fbx
Assets/_Project/Animation/Clips/Anim_Play_ColorGuard.fbx
Assets/_Project/Animation/Clips/Anim_Play_Leadership.fbx
Assets/_Project/Animation/Controllers/AC_BandMember_Base.controller
Assets/_Project/Animation/Controllers/AOC_Brass.overrideController
Assets/_Project/Animation/Controllers/AOC_Woodwind.overrideController
Assets/_Project/Animation/Controllers/AOC_BatteryPercussion.overrideController
Assets/_Project/Animation/Controllers/AOC_FrontEnsemble.overrideController
Assets/_Project/Animation/Controllers/AOC_ColorGuard.overrideController
Assets/_Project/Animation/Controllers/AOC_Leadership.overrideController
```

### Code Connection

- The `BandMember.prefab` has an Animator component using `AC_BandMember_Base`
- At runtime, when a member is assigned an instrument, the system looks up
  `InstrumentDefinition.AnimOverride` and sets
  `animator.runtimeAnimatorController = definition.AnimOverride`
- The AnimatorOverrideController references `AC_BandMember_Base` as its base
  and overrides specific clips

---

## 12. Audio

### Song Creation Workflow

#### Option A: Compose from Scratch (Recommended)

1. Write the arrangement in **MuseScore 4** with separate staves per family:
   - Brass staff (trumpets, trombones, horns combined)
   - Woodwind staff
   - Battery percussion staff
   - Front ensemble staff
   - A click/count track for color guard timing
2. Export each staff as a separate MIDI file
3. Import each MIDI into **LMMS** or a DAW, assign realistic soundfonts
4. Render each as a mono OGG Vorbis file (one per stem)
5. Also render a full stereo mix

#### Option B: Stem Separation from Existing Audio

If you have a full mix (that you have rights to use):

1. Run through **Demucs** (Meta's AI stem separator):
   ```bash
   demucs --two-stems=vocals input.mp3  # or use the 6-stem model
   ```
2. You will not get marching-band-specific stems, but you can get
   drums, bass, vocals, and other. Map these to your families as best you can.
3. Export each stem as mono OGG.

### Stem File Organization

Each song gets a folder under Stems:

```
Assets/_Project/Audio/Music/Stems/{SongId}/
    Stem_Brass.ogg
    Stem_Woodwind.ogg
    Stem_BatteryPercussion.ogg
    Stem_FrontEnsemble.ogg
    Stem_ColorGuard.ogg          (timing/count track or ambient)
```

Full mix goes to:
```
Assets/_Project/Audio/Music/Songs/{SongId}_FullMix.ogg
```

### Unity AudioClip Import Settings

| Setting | Stems (OGG) | Full Mix (OGG) | SFX (WAV) |
|---------|-------------|----------------|-----------|
| Force To Mono | Yes | No (stereo) | Yes |
| Load Type | Compressed In Memory | Compressed In Memory* | Decompress On Load |
| Compression Format | Vorbis | Vorbis | PCM (WAV) or Vorbis |
| Quality | 70% | 70% | N/A |
| Sample Rate Setting | Preserve | Preserve | Optimize |

*For PC standalone, full mix can use Streaming. WebGL does not support
Streaming well -- use Compressed In Memory.

### Code Connection

`SongData` model (serialized as JSON):

```json
{
    "Id": "song_stars_and_stripes",
    "Title": "Stars and Stripes Forever",
    "Composer": "John Philip Sousa",
    "Arranger": "Staff",
    "BPM": 120.0,
    "BeatsPerMeasure": 4,
    "BeatUnit": 4,
    "TotalBeats": 480.0,
    "DurationSeconds": 240.0,
    "Difficulty": 5,
    "TempoChanges": [],
    "FullMixAddressableKey": "Audio_Song_StarsAndStripes_FullMix",
    "Stems": [
        { "Family": 0, "AddressableKey": "Audio_Stem_StarsAndStripes_Brass" },
        { "Family": 1, "AddressableKey": "Audio_Stem_StarsAndStripes_Woodwind" },
        { "Family": 2, "AddressableKey": "Audio_Stem_StarsAndStripes_BatteryPercussion" },
        { "Family": 3, "AddressableKey": "Audio_Stem_StarsAndStripes_FrontEnsemble" },
        { "Family": 4, "AddressableKey": "Audio_Stem_StarsAndStripes_ColorGuard" }
    ]
}
```

The `InstrumentFamily` enum serializes as integers:
- 0 = Brass
- 1 = Woodwind
- 2 = BatteryPercussion
- 3 = FrontEnsemble
- 4 = ColorGuard
- 5 = Leadership

`MusicConductorBehaviour.cs` loads the full mix into `_mainAudioSource` and
creates a `Dictionary<InstrumentFamily, AudioSource>` in `_stemSources` for
per-family volume/mute control via `SetStemVolume()` and `MuteStem()`.

Audio is loaded via Addressables. The `LocalContentCatalog.cs` currently uses
`Resources.Load<TextAsset>()` as a temporary approach. When Addressables are
wired up, it will use `Addressables.LoadAssetAsync<AudioClip>(key)`.

---

## 13. BeatMap JSON Files

BeatMap files define the rhythmic structure for synchronizing animations and
scoring to the music. They map directly to the `SongData` model.

### File Path

```
Assets/_Project/Audio/BeatMaps/{SongId}.json
```

### Format

```json
{
    "Id": "song_fight_default",
    "Title": "Default Fight Song",
    "Composer": "Original",
    "Arranger": "Staff",
    "BPM": 140.0,
    "BeatsPerMeasure": 4,
    "BeatUnit": 4,
    "TotalBeats": 280.0,
    "DurationSeconds": 120.0,
    "Difficulty": 3,
    "TempoChanges": [
        {
            "AtBeat": 128.0,
            "NewBPM": 152.0,
            "TransitionBeats": 8.0
        },
        {
            "AtBeat": 256.0,
            "NewBPM": 120.0,
            "TransitionBeats": 0.0
        }
    ],
    "FullMixAddressableKey": "Audio_Song_FightDefault_FullMix",
    "Stems": [
        { "Family": 0, "AddressableKey": "Audio_Stem_FightDefault_Brass" },
        { "Family": 1, "AddressableKey": "Audio_Stem_FightDefault_Woodwind" },
        { "Family": 2, "AddressableKey": "Audio_Stem_FightDefault_BatteryPercussion" },
        { "Family": 3, "AddressableKey": "Audio_Stem_FightDefault_FrontEnsemble" },
        { "Family": 4, "AddressableKey": "Audio_Stem_FightDefault_ColorGuard" }
    ]
}
```

### How to Calculate TotalBeats

```
TotalBeats = BPM * (DurationSeconds / 60)
```

If the song has tempo changes, calculate each section separately and sum.
The `SongData.GetBPMAtBeat()` method handles interpolation during playback.

### TempoChange Fields

- `AtBeat`: The beat number where the change begins
- `NewBPM`: The target BPM
- `TransitionBeats`: Number of beats to linearly interpolate (0 = instant)

---

## 14. ScriptableObject Data Assets

These are created inside Unity via `Assets > Create > MBHS > Data > ...`.

### InstrumentDefinition (24 total)

**File path**: `Assets/_Project/Data/Instruments/{InstrumentType}.asset`

Create one for each of the 24 instrument types. Menu path:
`Assets > Create > MBHS > Data > Instrument Definition`

Example for Trumpet:
- Type: `Trumpet`
- Family: `Brass`
- DisplayName: `"Trumpet"`
- Icon: (drag `Trumpet_Icon.png` sprite)
- ModelPrefabAddressableKey: `"Instrument_Trumpet"`
- HoldOffset: `(0.15, 1.2, 0.3)` (tune visually)
- HoldRotation: identity
- AnimOverride: (drag `AOC_Brass.overrideController`)
- VolumeContribution: `0.5`
- MinRecommendedCount: `12`
- MaxRecommendedCount: `20`
- DifficultyToLearn: `4`
- PhysicalDemand: `4`

### SchoolDefinition (1 per school)

**File path**: `Assets/_Project/Data/Schools/School_{SchoolId}.asset`

Menu path: `Assets > Create > MBHS > Data > School Definition`

### ScoringRubricDefinition

**File path**: `Assets/_Project/Data/ScoringRubrics/Rubric_{Name}.asset`

Menu path: `Assets > Create > MBHS > Data > Scoring Rubric`

Start with one default rubric:
- FormationWeight: 0.4
- MusicWeight: 0.35
- ShowmanshipWeight: 0.15
- DifficultyWeight: 0.1
- PositionErrorThreshold: 0.5
- FacingErrorThreshold: 10
- SkillInfluence: 0.7
- BalanceInfluence: 0.3
- MaxDifficultyBonus: 20

---

## 15. Addressables Setup

The project uses Unity Addressables for all runtime content loading. Here is
how to organize groups and assign keys.

### Installing & Initializing

If not already set up:
1. `Window > Package Manager > Addressables` (should already be installed)
2. `Window > Asset Management > Addressables > Groups`
3. If prompted, click "Create Addressables Settings" -- this creates files in
   `Assets/_Project/Settings/Addressables/` (or `Assets/AddressableAssetsData/`)

### Addressable Groups

Create these groups in the Addressables Groups window:

| Group Name | Contents | Bundle Mode | Notes |
|------------|----------|-------------|-------|
| `Core_Characters` | BandMember prefab, uniform materials | Pack Together | Always loaded |
| `Instruments` | All 24 instrument prefabs | Pack Together | Loaded when band is created |
| `UI_Icons` | All instrument icons, school logos | Pack Together | Loaded at UI init |
| `Audio_SFX` | All SFX clips | Pack Together | Small, always loaded |
| `Audio_Song_{SongId}` | Full mix + stems for one song | Pack Together | One group per song |
| `Environment_Stadium` | Stadium prefabs, textures | Pack Together | Loaded per scene |
| `VFX` | All VFX prefabs | Pack Together | Loaded on demand |
| `Schools_{SchoolId}` | Uniform variant, logo, theme | Pack Separately | Per-school DLC-ready |

### Addressable Key Naming Convention

```
{Category}_{AssetType}_{Name}

Examples:
  Instrument_Trumpet
  Instrument_SnareDrum
  Audio_Song_StarsAndStripes_FullMix
  Audio_Stem_StarsAndStripes_Brass
  Audio_Stem_StarsAndStripes_Woodwind
  Audio_SFX_Whistle
  UI_Icon_Trumpet
  UI_Logo_Lincoln
  Env_Stadium_Bleachers
  VFX_Confetti
  Uniform_Lincoln_Home
```

### How to Mark an Asset as Addressable

1. Select the asset (e.g., `Trumpet.prefab`) in the Project window
2. In the Inspector, check the **Addressable** checkbox
3. Set the address to the key name (e.g., `Instrument_Trumpet`)
4. Assign it to the correct group

Or do it programmatically via the Addressables Groups window: drag the asset
into the group, then rename the key.

### Loading Assets in Code

The current `LocalContentCatalog.cs` uses `Resources.Load()` as a temporary
approach. When migrating to Addressables:

```csharp
// Loading an instrument prefab
var handle = Addressables.LoadAssetAsync<GameObject>(definition.ModelPrefabAddressableKey);
handle.Completed += op => {
    if (op.Status == AsyncOperationStatus.Succeeded)
        Instantiate(op.Result, holdPosition, holdRotation, parentTransform);
};

// Loading an audio stem
var audioHandle = Addressables.LoadAssetAsync<AudioClip>(stemRef.AddressableKey);
audioHandle.Completed += op => {
    _stemSources[stemRef.Family].clip = op.Result;
};
```

### WebGL Bundle Considerations

- Keep each bundle under **4 MB** for WebGL (browser memory constraints)
- Song audio bundles will be the largest; one bundle per song allows
  on-demand loading
- Use `Addressables.GetDownloadSizeAsync()` to show loading progress
- Run `Build > New Build > Default Build Script` to generate bundles
- For WebGL, set `Bundle Naming Mode` to `Use Hash Of AssetBundle` to
  leverage browser caching

### Building Addressables

Before every build:
1. `Window > Asset Management > Addressables > Groups`
2. `Build > New Build > Default Build Script`
3. Check the `Build` folder size. WebGL bundles should total < 50 MB ideally.

---

## 16. URP + WebGL Gotchas

These are the specific pitfalls that will waste your time if you do not know
about them in advance.

### Shaders

| Problem | Solution |
|---------|----------|
| Standard Shader (Built-in) renders pink in URP | Only use URP shaders: `Universal Render Pipeline/Lit`, `Universal Render Pipeline/Simple Lit`, `Universal Render Pipeline/Unlit`, or Shader Graph |
| Custom Shader Graph does not compile for WebGL | Avoid compute shaders, SSBO, structured buffers. Stick to vertex/fragment operations |
| Shader variants explode build size | In URP Asset, disable unused features (e.g., HDR, SSAO if not using). Use `Shader Variant Collection` to strip unused variants. Under `Edit > Project Settings > Graphics`, set `Shader Stripping` aggressively |
| VFX Graph does not work in WebGL | VFX Graph requires compute shaders. Use Particle System (Shuriken) instead |
| Shader compilation stutter on WebGL | Preload shaders in a loading screen using `Shader.WarmupAllShaders()` |

### Textures

| Problem | Solution |
|---------|----------|
| Textures appear blurry/wrong in WebGL | WebGL uses ETC2/ASTC compression on mobile browsers, DXT on desktop. Set per-platform overrides in import settings |
| Texture memory exceeds WebGL limits | Keep total uncompressed texture memory below ~256 MB. Use the smallest resolution that looks acceptable |
| NPOT (non-power-of-two) textures | WebGL works best with power-of-two dimensions: 64, 128, 256, 512, 1024, 2048. Non-POT textures cannot be compressed or tiled |
| Sprite atlas too large | Max 2048x2048 for WebGL sprite atlases |

### Audio

| Problem | Solution |
|---------|----------|
| MP3 does not play in Firefox WebGL | Use OGG Vorbis for all music |
| Audio Streaming not supported in WebGL | Set Load Type to `Compressed In Memory` (not Streaming) |
| Large AudioClips cause out-of-memory | Keep individual clips under 10 MB compressed. Split long songs into stems |
| Audio starts with a pop/click in WebGL | WebGL AudioContext requires a user gesture. Ensure first audio plays after a button click, not on scene load |

### Rendering

| Problem | Solution |
|---------|----------|
| Too many draw calls kills WebGL FPS | Target < 100 draw calls. Use GPU Instancing on band member materials (enable in material settings). Use texture atlases. Use `Static Batching` for stadium |
| Shadows expensive in WebGL | Use a single cascading shadow from the directional light. Set shadow resolution to 1024. Consider disabling real-time shadows for band members and using blob shadow decals instead |
| Post-processing too expensive | Avoid Bloom, DOF, and motion blur on WebGL. Vignette and color grading are cheap. Set these per-quality in URP Asset |
| Reflection probes crash WebGL | Use at most 1 reflection probe, resolution 128. Or skip them entirely |
| Real-time lights expensive | Limit to 1 directional + 4 additional per-pixel lights in URP settings |

### Build Size

| Problem | Solution |
|---------|----------|
| WebGL build too large (>100 MB) | Enable Brotli compression in `Player Settings > WebGL > Compression Format`. Strip managed code: `IL2CPP > Managed Stripping Level = Medium or High`. Remove unused packages |
| Addressable bundles too large | Split audio into per-song bundles. Check `Addressables Event Viewer` for bundle sizes |
| Font assets bloated | Create font atlases with only the character sets you need (ASCII + common punctuation) |

### Miscellaneous

| Problem | Solution |
|---------|----------|
| `SystemInfo.supportsInstancing` is false on some WebGL targets | Check at runtime and fall back to non-instanced rendering. Use `MaterialPropertyBlock` for per-instance colors |
| Cloth physics does not work in WebGL | Bake cloth animation (flags) instead of using Unity's Cloth component |
| `Time.deltaTime` spikes in WebGL | WebGL runs on the browser's requestAnimationFrame. Use `Time.unscaledDeltaTime` for time-critical code and clamp large delta values |

---

## 17. Asset Store Placeholder Strategy

You do not need to create every asset from scratch. Use placeholders to move
fast and replace them later.

### Recommended Free/Cheap Asset Store Packs

Search the Unity Asset Store for these categories:

| Need | Search Terms | Notes |
|------|-------------|-------|
| Character placeholder | "Low poly character", "Stylized character" | Look for humanoids with Humanoid rig |
| Instruments | "Musical instruments 3D" | Rare on Asset Store; may need to model |
| Stadium | "Stadium", "Sports arena", "Bleachers" | Check poly count; may need decimation |
| Skybox | "Night skybox", "Stadium skybox" | Many free options |
| UI kit | "UI kit URP", "Sci-fi UI" | Adapt to your style |
| SFX | "Crowd sounds", "Sports SFX", "UI sounds" | Check license (royalty-free) |
| Animations | "Locomotion animations", "Walk cycle" | Must be Humanoid-rigged |
| VFX | "Particle effects URP", "Cartoon VFX URP" | Must say "URP compatible" |

### Placeholder Workflow

1. Import the asset pack into a folder: `Assets/ThirdParty/{PackName}/`
   (NOT inside `_Project/` -- keep third-party assets separate)
2. Create a prefab variant or material reference inside `_Project/` that
   points to the third-party asset
3. Wire the `_Project/` reference into your ScriptableObjects
4. When you create the real asset, swap the reference. Nothing else changes.

### License Warnings

- **Free Asset Store assets**: Usually licensed only for use in Unity projects.
  Read each license. Some prohibit redistribution of raw assets.
- **CC0 / Public Domain**: Safe for any use. Sites: polyhaven.com, kenney.nl
- **CC-BY**: Requires attribution. Fine for games, just add to credits.
- **CC-BY-NC**: Non-commercial only. Do NOT use if you plan to sell the game.

---

## 18. Quick-Reference: File Path Map

Complete map of where every asset type lives, relative to project root.

```
Assets/_Project/
│
├── Art/
│   ├── Characters/
│   │   ├── BandMember/
│   │   │   └── BandMember.fbx                    # Base character mesh
│   │   ├── Instruments/
│   │   │   ├── Trumpet.fbx                       # One FBX per InstrumentType
│   │   │   ├── Trombone.fbx
│   │   │   ├── ... (24 total)
│   │   │   ├── M_BrassInstrument.mat             # Shared materials
│   │   │   ├── M_WoodInstrument.mat
│   │   │   └── M_GuardProp.mat
│   │   └── Uniforms/
│   │       ├── T_Uniform_ColorMask.png            # RGB channel mask
│   │       ├── T_Uniform_Base_Diffuse.png         # Base fabric texture
│   │       ├── M_Uniform_Home.mat
│   │       ├── M_Uniform_Away.mat
│   │       └── Uniform_Shako.fbx                  # Drum major hat
│   │
│   ├── Environment/
│   │   ├── Stadium/
│   │   │   ├── Stadium_Bleachers.fbx
│   │   │   ├── Stadium_PressBox.fbx
│   │   │   ├── Stadium_GoalPost.fbx
│   │   │   ├── Stadium_Scoreboard.fbx
│   │   │   ├── Stadium_Lights.fbx
│   │   │   ├── Stadium_Track.fbx
│   │   │   ├── Stadium_Fence.fbx
│   │   │   ├── T_Stadium_Atlas_Diffuse.png
│   │   │   ├── T_Stadium_Atlas_Normal.png
│   │   │   └── T_FieldTurf_Diffuse.png
│   │   ├── Props/
│   │   │   ├── Prop_WaterCooler.fbx
│   │   │   └── Prop_EquipmentCart.fbx
│   │   └── Skybox/
│   │       └── M_Skybox_FridayNight.mat
│   │
│   ├── UI/
│   │   ├── Icons/
│   │   │   ├── Trumpet_Icon.png                   # One per InstrumentType
│   │   │   ├── ... (24 instrument icons)
│   │   │   ├── School_Default_Logo.png            # One per SchoolId
│   │   │   └── School_{SchoolId}_Logo.png
│   │   ├── Sprites/
│   │   │   ├── Atlas_InstrumentIcons.spriteatlasv2
│   │   │   ├── Atlas_UIElements.spriteatlasv2
│   │   │   ├── Panel_Background.png
│   │   │   ├── Button_Default.png
│   │   │   ├── Button_Hover.png
│   │   │   └── Button_Pressed.png
│   │   └── Fonts/
│   │       ├── Roboto-Regular.ttf
│   │       └── Oswald-Bold.ttf
│   │
│   └── VFX/
│       ├── VFX_FormationTrail.prefab
│       ├── VFX_SelectionRing.prefab
│       ├── VFX_ScorePopup.prefab
│       ├── VFX_Confetti.prefab
│       └── VFX_LightFlare.prefab
│
├── Audio/
│   ├── Music/
│   │   ├── Songs/
│   │   │   ├── Song_Default_FullMix.ogg
│   │   │   └── {SongId}_FullMix.ogg
│   │   └── Stems/
│   │       └── {SongId}/
│   │           ├── Stem_Brass.ogg
│   │           ├── Stem_Woodwind.ogg
│   │           ├── Stem_BatteryPercussion.ogg
│   │           ├── Stem_FrontEnsemble.ogg
│   │           └── Stem_ColorGuard.ogg
│   ├── BeatMaps/
│   │   ├── Song_Default.json
│   │   └── {SongId}.json
│   └── SFX/
│       ├── SFX_Whistle.wav
│       ├── SFX_CrowdAmbient.wav
│       ├── SFX_CrowdCheer_01.ogg
│       ├── SFX_CrowdCheer_02.ogg
│       ├── SFX_UI_Click.wav
│       ├── SFX_UI_PanelOpen.wav
│       ├── SFX_UI_Success.wav
│       ├── SFX_UI_Failure.wav
│       ├── SFX_ScoreReveal.wav
│       ├── SFX_MetronomeTick.wav
│       └── SFX_FormationSnap.wav
│
├── Animation/
│   ├── Rigs/
│   │   ├── BandMember_Rig.fbx
│   │   └── AvatarMask_UpperBody.mask
│   ├── Clips/
│   │   ├── Anim_Idle.fbx
│   │   ├── Anim_March_Forward.fbx
│   │   ├── Anim_March_InPlace.fbx
│   │   ├── Anim_March_TurnLeft.fbx
│   │   ├── Anim_March_TurnRight.fbx
│   │   ├── Anim_Halt.fbx
│   │   ├── Anim_Attention.fbx
│   │   ├── Anim_AtEase.fbx
│   │   ├── Anim_Play_Brass.fbx
│   │   ├── Anim_Play_Woodwind.fbx
│   │   ├── Anim_Play_BatteryPercussion.fbx
│   │   ├── Anim_Play_FrontEnsemble.fbx
│   │   ├── Anim_Play_ColorGuard.fbx
│   │   └── Anim_Play_Leadership.fbx
│   └── Controllers/
│       ├── AC_BandMember_Base.controller
│       ├── AOC_Brass.overrideController
│       ├── AOC_Woodwind.overrideController
│       ├── AOC_BatteryPercussion.overrideController
│       ├── AOC_FrontEnsemble.overrideController
│       ├── AOC_ColorGuard.overrideController
│       └── AOC_Leadership.overrideController
│
├── Data/
│   ├── Instruments/
│   │   ├── Trumpet.asset                          # 24 InstrumentDefinition SOs
│   │   ├── Trombone.asset
│   │   ├── FrenchHorn.asset
│   │   ├── Tuba.asset
│   │   ├── Sousaphone.asset
│   │   ├── Baritone.asset
│   │   ├── Mellophone.asset
│   │   ├── Flute.asset
│   │   ├── Piccolo.asset
│   │   ├── Clarinet.asset
│   │   ├── Saxophone.asset
│   │   ├── SnareDrum.asset
│   │   ├── BassDrum.asset
│   │   ├── TenorDrums.asset
│   │   ├── Cymbals.asset
│   │   ├── Xylophone.asset
│   │   ├── Marimba.asset
│   │   ├── Vibraphone.asset
│   │   ├── Timpani.asset
│   │   ├── Flag.asset
│   │   ├── Rifle.asset
│   │   ├── Saber.asset
│   │   └── DrumMajor.asset
│   ├── Schools/
│   │   ├── School_Default.asset
│   │   └── School_{SchoolId}.asset
│   ├── ScoringRubrics/
│   │   └── Rubric_Standard.asset
│   └── Defaults/
│       └── (default configuration SOs if needed)
│
├── Prefabs/
│   ├── Characters/
│   │   ├── BandMember.prefab
│   │   └── Instruments/
│   │       ├── Trumpet.prefab                     # 24 instrument prefabs
│   │       ├── Trombone.prefab
│   │       └── ... (one per InstrumentType)
│   ├── Environment/
│   │   ├── Stadium.prefab
│   │   ├── GoalPost.prefab
│   │   └── ...
│   ├── UI/
│   │   └── (UI prefabs if any are non-UXML)
│   └── Systems/
│       └── (manager/singleton prefabs)
│
├── Settings/
│   ├── URP/                                       # URP pipeline assets
│   ├── Input/                                     # Input Action maps
│   └── Addressables/                              # Addressable group schemas
│
├── UI/
│   ├── Documents/
│   │   ├── FormationEditor.uxml
│   │   └── MainMenu.uxml
│   ├── Styles/
│   │   ├── FormationEditor.uss
│   │   └── MainMenu.uss
│   └── Templates/
│       └── (reusable UXML components)
│
└── Scenes/
    ├── Boot.unity
    ├── MainMenu.unity
    ├── BandManagement.unity
    ├── FormationEditor.unity
    └── ShowSimulation.unity
```

---

## Appendix A: First Weekend Quickstart

If you have one weekend to make visible progress, do exactly this:

### Saturday Morning (2 hours): Character

1. Install Blender. Open it. Delete the default cube.
2. `Add > Mesh > Cylinder`. Scale Y to 1.8 (body height). This is the torso.
3. Add arms, legs, head as scaled cylinders/spheres. Join them (`Ctrl+J`).
4. Keep it under 2,000 triangles. It will look like a mannequin. That is fine.
5. UV unwrap (`U > Smart UV Project`). Assign a single flat color material.
6. Export as FBX: `Assets/_Project/Art/Characters/BandMember/BandMember.fbx`

### Saturday Afternoon (2 hours): Rig + Animations

1. Go to mixamo.com. Upload your FBX.
2. Let Mixamo auto-rig. Download the rigged model (FBX for Unity, with skin).
3. Search "Walking" animation. Download (Without Skin, 30fps).
4. Search "Idle" animation. Download.
5. Save to `Assets/_Project/Animation/Clips/`
6. In Unity, set Animation Type = Humanoid on all FBX files.

### Saturday Evening (2 hours): Animator + Prefab

1. In Unity, create Animator Controller: `AC_BandMember_Base`
2. Add states: Idle (default), MarchForward. Add bool `IsMarching`.
3. Create transitions with `IsMarching` condition.
4. Create `BandMember.prefab` with the rigged mesh + Animator.
5. Test: the prefab should idle, and march when `IsMarching` = true.

### Sunday Morning (2 hours): Icons + Data

1. In Krita, create a 128x128 canvas. Draw a trumpet silhouette (white on
   transparent). Export as `Trumpet_Icon.png`. Repeat for 4--5 key instruments.
   The rest can wait.
2. In Unity, create InstrumentDefinition assets for those instruments.
3. Assign the icons.

### Sunday Afternoon (2 hours): Audio + BeatMap

1. Find a royalty-free marching band track (freesound.org, incompetech.com).
2. Import into Audacity. Export as OGG.
3. Write a BeatMap JSON by tapping along to find BPM (use an online BPM tapper).
4. Save both to the Audio folders.

After this weekend you have: a rigged character that marches, a handful of
instrument icons wired to ScriptableObjects, and a song with beat data. The
capsules are gone. Everything else is incremental from here.

---

## Appendix B: Blender-to-Unity FBX Export Checklist

Every time you export from Blender, verify these settings:

```
Export FBX Settings:
  Path Mode:           Copy (and embed textures checkbox)
  Forward:             -Z Forward
  Up:                  Y Up
  Apply Scalings:      FBX All
  Apply Unit:          Checked
  Apply Transform:     Checked
  Mesh:
    Smoothing:         Face
    Tangent Space:     Checked (if using normal maps)
  Armature:
    Add Leaf Bones:    UNCHECKED (Unity does not need them)
    Primary Bone Axis: Y
    Secondary Bone Axis: X
```

Failure to uncheck "Add Leaf Bones" adds unnecessary bones that clutter the
hierarchy. Failure to set the axis correctly causes 90-degree rotation issues
in Unity.

---

## Appendix C: Content Manifest for LocalContentCatalog

The `LocalContentCatalog.cs` loads a `content_manifest` JSON from Resources.
When you add new songs or content, update this file:

```
Assets/Resources/content_manifest.json
```

```json
{
    "Version": "0.1.0",
    "LastUpdated": "2026-02-16T00:00:00Z",
    "Entries": [
        {
            "Id": "song_fight_default",
            "Title": "Default Fight Song",
            "Author": "Staff",
            "Type": 0,
            "AddressableKey": "Audio_Song_FightDefault_FullMix",
            "ThumbnailAddressableKey": "",
            "IsOwned": true,
            "IsBuiltIn": true,
            "Description": "A classic marching band fight song.",
            "Tags": ["fight-song", "beginner"]
        }
    ]
}
```

`ContentType` enum values for the `Type` field:
- 0 = Song
- 1 = FormationTemplate
- 2 = UniformDesign
- 3 = StadiumTheme
- 4 = ShowPackage
